<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.green.smart_grade.professor.professorgradeMngmn.professorGradeMngmnMapper">
    <update id="upMngnm">
        UPDATE lecture_student A
        INNER JOIN lecture_applly B ON A.ilecture = B.ilecture
        SET A.attendance =
        CASE WHEN #{attendance} > B.attendance THEN B.attendance ELSE #{attendance} END,
        A.midterm_examination =
        CASE WHEN #{midtermExamination} > B.midterm_examination THEN B.midterm_examination ELSE #{midtermExamination} END,
        A.final_examination =
        CASE WHEN #{finalExamination} > B.final_examination THEN B.final_examination ELSE #{finalExamination} END,
        A.total_score =
        CASE
        WHEN #{attendance} > B.attendance THEN B.attendance ELSE #{attendance}
        END +
        CASE
        WHEN #{midtermExamination} > B.midterm_examination THEN B.midterm_examination ELSE #{midtermExamination}
        END +
        CASE
        WHEN #{finalExamination} > B.final_examination THEN B.final_examination ELSE #{finalExamination}
        END,
        A.finished_yn = 1,
        A.update_at = NOW()
        WHERE A.ilecture_student = #{ilectureStudent} AND B.iprofessor = #{ipofessor}
    </update>



</mapper>